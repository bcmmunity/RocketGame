@model IEnumerable<RocketGame.Models.User>

@{
	ViewData["Title"] = "ShowUsers";
}

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
<h2>Секретный код - @ViewBag.Promo</h2>

<a href="/Home/ShowUsers?Key=@ViewBag.Key">Обновить</a>

<a id="s"><span onclick="makeMove()">Начать игру</span></a>


<table class="table" id="t">
	<thead>
		<tr>
			<th>
				@Html.DisplayNameFor(model => model.Name)
			</th>
			<th>
				@Html.DisplayNameFor(model => model.Intellect)
			</th>
			<th>
				@Html.DisplayNameFor(model => model.Power)
			</th>
			<th>
				@Html.DisplayNameFor(model => model.InRocket)
			</th>
			<th>
				Команда
			</th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		@foreach (var item in Model)
		{
			<tr>
				<td>
					@Html.DisplayFor(modelItem => item.Name)
				</td>
				<td>
					@Html.DisplayFor(modelItem => item.Intellect)
				</td>
				<td>
					@Html.DisplayFor(modelItem => item.Power)
				</td>
				<td>
					@Html.DisplayFor(modelItem => item.InRocket)
				</td>
				<td>
					@item.Team.Name
				</td>
				<td>
					<a href="/Home/EditUser?id=@item.UserId&key=@ViewBag.Key">Изменить</a>
				</td>
			</tr>
		}
	</tbody>
</table>

<script>


	function makeMove() {
		$.ajax({
			type: "GET",
			url: "/Game/StartGame",

			success: function (result) {
				$("#s").empty();
				$("#s").append("<h2>Игра началась</h2>");
			}
		});
	}

	$(document).ready(function () {
		$.ajax({
			type: "GET",
			url: "/Game/GameCheck",
			success: function (result) {
				if (result == "Игра началась") {
					$("#s").empty();
					$("#s").append("<h2>Игра началась</h2>");
				}
			}
		})
	});
</script>
